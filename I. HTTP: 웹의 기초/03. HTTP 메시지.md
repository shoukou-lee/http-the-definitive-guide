## 메시지의 흐름
### 인바운드와 아웃바운드
![inbound-outbound](/figures/inbound-outbound.png)
- 트랜잭션 흐름 방향을 의미
- 인바운드 : 서버로 향하는 메시지
- 아웃바운드 : 클라이언트로 향하는 메시지

### 업스트림과 다운스트림
![upstream-downstream](/figures/upstream-downstream.png)
- 요청, 응답에 관계 없이 모든 메시지의 흐름 방향은 다운스트림
- 메시지 발송자는 수신자의 업스트림

## 메시지 구조
- 메시지는 시작줄(Startline), 헤더(Header), 본문(Body)로 구성
- 요청 메시지와 응답 메시지의 시작줄 문법이 다름
    - 요청 메시지
    ```
    <메서드> <요청 URL> <버전> 
    <headers>
    
    <body>
    ```
    - 응답 메시지
    ```
    <버전> <상태 코드> <reason-phrase>
    <headers>
    
    <body>
    ```
![message](/figures/message.png)

### Startline
- 요청줄은 `<메서드> <요청 URL> <버전>` 형태로 구성
- 응답줄은 `<버전> <상태 코드> <reason-phrase>`로 구성

#### 메서드
- 서버에게 무엇을 해야 하는지 말해줌
- 메서드에 따라 요청 메시지의 body 유무가 다름

#### 상태 코드
- 서버의 처리 결과를 클라이언트에게 알려주는 세자리 숫자로 이루어진 코드
- `2XX - 성공` `3XX - 리디렉션` `4XX - 클라이언트 에러` `5XX - 서버 에러`
- 클라이언트가 HTTP 명세에 정의된 범위 외의 상태 코드를 받더라도, 상태 코드 첫자리의 의미에 맞게 다루어야 함
- ![http-status](/figures/http-status.png)

#### Reason phrase
- 상태 코드에 대한 디테일한 설명을 사람이 이해하기 쉬운 문장으로 제공

#### 버전 번호
- `HTTP/1.1`와 같이 `HTTP/메이저버전.마이너버전` 형식으로 표현
- HTTP 애플리케이션이 자신들이 지원하는 가장 높은 버전의 HTTP 프로토콜을 상대방에게 알려주기 위함

### Headers
- 0개 이상의 `key: value, ..., value`로 구성
- Body에 대한 정보 제공
- `CRLF(Carriage Return Line Feed, 줄바꿈)`로 끝나야 하며, 이를 기준으로 각각의 헤더와 본문을 구분함
- 일반 헤더, 요청 헤더, 응답 해더, 엔티티 헤더, 확장 헤더로 분류됨

    |헤더 분류|내용|
    |------|---|
    |일반 헤더|요청과 응답 양쪽에 모두 나타날 수 있음|
    |요청 헤더|요청에 대한 부가 정보 제공|
    |응답 헤더|응답에 대한 부가 정보 제공|
    |엔티티 헤더|본문 크기, 콘텐츠, 리소스를 서술|
    |확장 헤더|명세에 정의되지 않은 새로운 헤더|

### Body
- 텍스트, 비디오, 이미지, 문서 등의 데이터 블록을 담는 부분
- Body에는 내용이 있거나 없을 수도 있으며, 어떤 경우에도 항상 CRLF로 끝나야 함.


