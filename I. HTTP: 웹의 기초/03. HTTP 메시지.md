## 메시지의 흐름
### 인바운드와 아웃바운드
![inbound-outbound](/figures/inbound-outbound.png)
- 트랜잭션 흐름 방향을 의미
- 인바운드 : 서버로 향하는 메시지
- 아웃바운드 : 클라이언트로 향하는 메시지

### 업스트림과 다운스트림
![upstream-downstream](/figures/upstream-downstream.png)
- 요청, 응답에 관계 없이 모든 메시지의 흐름 방향은 다운스트림
- 메시지 발송자는 수신자의 업스트림

## 메시지 구조
- 메시지는 시작줄(Startline), 헤더(Header), 본문(Body)로 구성
- 요청 메시지와 응답 메시지의 시작줄 문법이 다름
    - 요청 메시지
    ```
    <메서드> <요청 URL> <버전> 
    <headers>
    
    <body>
    ```
    - 응답 메시지
    ```
    <버전> <상태 코드> <reason-phrase>
    <headers>
    
    <body>
    ```
![message](/figures/message.png)

### Startline
- 요청줄은 `<메서드> <요청 URL> <버전>` 형태로 구성
- 응답줄은 `<버전> <상태 코드> <reason-phrase>`로 구성

#### 메서드
- 서버에게 무엇을 해야 하는지 말해줌
- 메서드에 따라 요청 메시지의 body 유무가 다름

#### 상태 코드
- 서버의 처리 결과를 클라이언트에게 알려주는 세자리 숫자로 이루어진 코드
- 일부 코드는 HTTP 명세에 사전에 정의된 상태 코드
- 1XX 정보성 상태 코드
    - HTTP/1.1에 도입된 코드.
- 2XX 성공
    - 클라이언트의 요청이 서버에서 받아들여졌거나 처리되었음을 의미하는 응답
- 3XX 리다이렉션
    - 클라이언트가 요청한 리소스에 대해, 다른 위치를 사용해 접근하라는 의미
    - 브라우저는 3XX 코드를 받으면 Response body에 명시된 URL로 이동시켜줌
- 4XX 클라이언트 에러
    - 서버가 다룰 수 없는 잘못된 요청을 보낼 경우에 대한 응답
    - 일부 클라이언트 에러는 브라우저 선에서 처리되지만, 그렇지 않은 에러도 있음 (404 등)
- 5XX 서버 에러
    - 서버가 지원하지 않는 메서드를 호출하거나 서버가 요청을 처리할 수 없는 상황일 경우에 대한 응답
    

- 클라이언트가 HTTP 명세에 정의된 범위 외의 상태 코드를 받더라도, 상태 코드 첫자리의 의미에 맞게 다루어야 함
- ![http-status](/figures/http-status.png)

#### Reason phrase
- 상태 코드에 대한 디테일한 설명을 사람이 이해하기 쉬운 문장으로 제공

#### 버전 번호
- `HTTP/1.1`와 같이 `HTTP/메이저버전.마이너버전` 형식으로 표현
- HTTP 애플리케이션이 자신들이 지원하는 가장 높은 버전의 HTTP 프로토콜을 상대방에게 알려주기 위함

### Headers
- 0개 이상의 `key: value, ..., value`로 구성
- Body에 대한 정보 제공
- `CRLF(Carriage Return Line Feed, 줄바꿈)`로 끝나야 하며, 이를 기준으로 각각의 헤더와 본문을 구분함
- 일반 헤더, 요청 헤더, 응답 해더, 엔티티 헤더, 확장 헤더로 분류됨

    |헤더 분류|내용|예|
    |------|---|-|
    |일반 헤더|요청, 응답 양쪽 모두가 사용하는 헤더|`Date: Tue, 3 Oct 1974 02:16:00 GMT`|
    |요청 헤더|서버에게 요청 부가 정보 제공|`Accept: */*`|
    |응답 헤더|클라이언트에게 응답 부가 정보 제공|`Server: Tiki-Hut/1.0`|
    |엔티티 헤더|본문 크기, 콘텐츠, 리소스를 서술|`Content-Type: text/html`|
    |확장 헤더|명세에 정의되지 않은 비표준 헤더||

### Body
- 텍스트, 비디오, 이미지, 문서 등의 데이터 블록을 담는 부분
- Body에는 내용이 있거나 없을 수도 있으며, 어떤 경우에도 항상 CRLF로 끝나야 함.


## 메서드

### 안전한 메서드
- 요청으로 인해 서버에서 일어나는 일이 아무것도 없는 메서드
- 단, 안전한 메서드라 하여 서버에서 아무 일이 일어나지 않는다는 것을 보장하지는 않음. 이는 오로지 웹 개발자의 책임
- GET, HEAD

### GET
- 서버에게 리소스를 요청하는 메서드
- 서버는 Response body에 리소스를 담아 리턴

### HEAD
- GET과 같이 동작하지만, Response body는 리턴되지 않음
- 리소스를 받지 않고도 헤더로 타입을 유추, 응답 상태 코드로 개체 존재를 확인, 헤더를 통한 리소스 변경 검사 등의 목적으로 사용

### PUT
- 서버에 존재하는 리소스에 데이터를 입력하기 위해 사용
- 요청 URL의 자원이 존재한다면 Request body의 내용으로 수정하거나, 없다면 새 문서를 만듦.

### POST
- 서버에 데이터를 전송하기 위해 사용 (form data 등)

### DELETE
- 요청 URL로 지정한 리소스의 삭제
- HTTP 명세는 서버가 클라이언트에게 알리지 않고 요청을 무시할 수 있으므로 클라이언트는 리소스의 삭제를 확신할 수 없음
- 일반적으로 서버는 Request body를 무시
